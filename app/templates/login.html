{% extends 'base.html' %}
{% load static %}

{% block title %}
    <title>–í—Ö—ñ–¥ –¥–æ –∞–∫–∞—É–Ω—Ç—É</title>
    <link rel="icon" type="image/x-icon" href="{% static 'icons/icons8-brutus-32.ico' %}">
    <link rel="stylesheet" href="{% static 'css/login.css' %}">
{% endblock %}

{% block body %}

<div class="username-display">
  {% if user.username %}
    <a href="/settings" class="login-link">üë§ {{ user.username }}</a>
    <a href="/wallet" class="login-link">({{ user.wallet }})</a>
  {% else %}
    <a href="/login" class="login-link">üë§ –í–∏ –Ω–µ —É–≤—ñ–π—à–ª–∏ –≤ –∞–∫–∞—É–Ω—Ç</a>
    <a href="/login" class="login-link">–£–≤—ñ–π—Ç–∏</a>
  {% endif %}
  <div class="switch-wrapper">
    <label class="switch" title="–ü–µ—Ä–µ–º–∫–Ω—É—Ç–∏ —Ç–µ–º—É">
      <input type="checkbox" id="themeToggle" aria-label="Theme toggle">
      <span class="slider"></span>
    </label>
  </div>
</div>

<div class="background">
    <div class="container">
        <form method="post" action="{% url 'login' %}" class="form">
            {% csrf_token %}
            <h2>–í—Ö—ñ–¥ –¥–æ –∞–∫–∞—É–Ω—Ç—É</h2>
            {% if messages %}
                {% for message in messages %}
                    <p class="{% if message.tags == 'success' %}message{% else %}error-msg{% endif %}">
                      {{ message }}
                    </p>
                {% endfor %}
            {% endif %}
            <label>–Ü–º‚Äô—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:
                <input type="text" name="username" required>
            </label>
            
            <label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É:
                <input type="text" name="phone_number" required>
            </label>

            <label>Email:
                <input type="email" name="email" required>
            </label>
            
            <label>–ü–∞—Ä–æ–ª—å:
                <input type="password" name="password" required>
            </label>

            <button type="submit">–£–≤—ñ–π—Ç–∏</button>
        </form>

        <div class="bottom-link">
            <p>–ù–µ–º–∞—î –∞–∫–∞—É–Ω—Ç–∞?</p>
            <a href="{% url 'register' %}" class="register-button">–°—Ç–≤–æ—Ä–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç</a>
        </div>

        <div class="bottom-link">
            <p>–•–æ—á–µ—à –≤–∏–¥–∞–ª–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç?</p>
            <a href="{% url 'register-delete' %}" class="register-button">–í–∏–¥–∞–ª–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç</a>
        </div>
    </div>
</div>

<div class="username-display">
  {% if user.username %}
    <div id="menu" class="styled-button" onclick="redirectToMenu()">
      üî•
      <span style="color: #6a5acd; text-decoration: none; font-weight: bold;">–ú–µ–Ω—é</span>
      üî•
    </div>
  {% else %}
    <div id="menu" class="styled-button" onclick="redirectToMenuNone()">
      üî•
      <span style="color: #6a5acd; text-decoration: none; font-weight: bold;">–ú–µ–Ω—é</span>
      üî•
    </div>
  {% endif %}
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggle = document.getElementById("themeToggle");
    const html = document.documentElement;

    if (localStorage.getItem("darkTheme") === "true") {
      html.classList.add("dark-theme");
      toggle.checked = true;
    }

    toggle.addEventListener("change", function () {
      html.classList.toggle("dark-theme", this.checked);
      localStorage.setItem("darkTheme", this.checked);
    });
  });
</script>

<script>
  function redirectToMenu() {
    window.location.href = "/menu/{{ user.id }}";
  }

  function redirectToMenuNone() {
    window.location.href = "/menu/none";
  }
</script>
{% endblock %}
