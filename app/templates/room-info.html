{% extends 'base.html' %}
{% load static %}

{% block title %}
    <title>{{ title }}</title>
    <link rel="icon" type="image/x-icon" href="{% static 'icons/icons8-brutus-32.ico' %}">
    <link rel="stylesheet" href="{% static 'css/room-info.css' %}">
{% endblock %}

{% block body %}
<div class="username-display">
  {% if user.username %}
    <a href="/settings" class="login-link">üë§ {{ user.username }}</a>
    <a href="/wallet" class="login-link">({{ user.wallet }})</a>
  {% else %}
    <a href="/login" class="login-link">üë§ –í–∏ –Ω–µ —É–≤—ñ–π—à–ª–∏ –≤ –∞–∫–∞—É–Ω—Ç</a>
    <a href="/login" class="login-link">–£–≤—ñ–π—Ç–∏</a>
  {% endif %}
  <div class="switch-wrapper">
    <label class="switch" title="–ü–µ—Ä–µ–º–∫–Ω—É—Ç–∏ —Ç–µ–º—É">
      <input type="checkbox" id="themeToggle" aria-label="Theme toggle">
      <span class="slider"></span>
    </label>
  </div>
</div>

<div class="background">
  <div class="container">
    <div style="display: flex; align-items: flex-start; gap: 20px; margin-bottom: 20px;">
      {% if room.photo %}
        <img src="{{ room.photo.url }}"
             alt="–§–æ—Ç–æ –∫—ñ–º–Ω–∞—Ç–∏"
             style="width: 300px; height: 200px; object-fit: cover; border-radius: 8px;">
      {% else %}
        <p class="theme-text"><em>–§–æ—Ç–æ –≤—ñ–¥—Å—É—Ç–Ω—î</em></p>
      {% endif %}

      <div>
        <h2 class="theme-text" style="margin: 0 0 8px 0;">{{ room.title }}</h2>
        <p class="theme-text" style="margin: 0; font-weight: bold;">–¶—ñ–Ω–∞: {{ room.price }} –≥—Ä–Ω</p>
      </div> 
    </div>
    <p class="theme-text"><strong>–ê–¥—Ä–µ—Å–∞:</strong> {{ room.address }}</p>
    <p class="theme-text"><strong>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É:</strong> {{ room.phone_number }}</p>
    <div class="vertical-menu">
    {% if user.username %}
      <button onclick="location.href='/rent/user_id={{ user.id }}/room_id={{ room.id }}'">–ó–≤'—è–∑–∞—Ç–∏—Å—è</button>
    {% else %}
      <button onclick="location.href='/error-continued'">–ó–≤'—è–∑–∞—Ç–∏—Å—è</button>
    {% endif %}
    </div>
  </div>
</div>

<div class="username-display">
  {% if user.username %}
    <div id="menu" class="styled-button" onclick="redirectToMenu()">
      üî•
      <span style="color: #6a5acd; text-decoration: none; font-weight: bold;">–ú–µ–Ω—é</span>
      üî•
    </div>
  {% else %}
    <div id="menu" class="styled-button" onclick="redirectToMenuNone()">
      üî•
      <span style="color: #6a5acd; text-decoration: none; font-weight: bold;">–ú–µ–Ω—é</span>
      üî•
    </div>
  {% endif %}
</div>

<script>
    function redirectToMenu() {
        window.location.href = "/menu/{{ user.id }}";
    }

    function redirectToMenuNone() {
        window.location.href = "/menu/none";
    }

    document.addEventListener("DOMContentLoaded", function () {
      const toggle = document.getElementById("themeToggle");
      const html = document.documentElement;

      if (localStorage.getItem("darkTheme") === "true") {
        html.classList.add("dark-theme");
        toggle.checked = true;
      }

      toggle.addEventListener("change", function () {
        html.classList.toggle("dark-theme", this.checked);
        localStorage.setItem("darkTheme", this.checked);
      });
    });
</script>
{% endblock %}
